---
title: "HDT1 Análisis exploratorio de datos"
author: "Cristopher Barrios, Carlos Daniel Estrada"
date: "3/2/2023"
output:
  html_document:
  code_folding: hide
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
datos <- read.csv("movies.csv")

```

### 1. (3 puntos) Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos.
```{r}
summary(datos)
```



### 2. (5 puntos) Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)

```{r}
NombreDeLaVariables <- c("id", "popularity", "budget", "revenue", "original_title", "originalLanguage", "title", "homePage", "video", "director", "runtime", "genres", "genresAmount", "productionCompany", "productionCoAmount", "productionCompanyCountry", "productionCountry", "productionCountriesAmount", "releaseDate", "voteCount", "voteAvg", "actors", "actorsPopularity", "actorsCharacter", "actorsAmount", "castWomenAmount", "CastMenAmount")

Continua <- c("", "x", "", "x", "", "", "", "", "", "", "x", "", "", "", "x", "", "", "", "", "", "x", "", "", "", "", "", "")
Discreta <- c("x", "", "x", "", "", "", "", "", "", "", "", "", "x", "", "", "", "", "x", "", "x", "", "", "", "", "x", "x", "x")
Nominal <- c("", "", "", "", "x", "x", "x", "x", "x", "x", "", "x", "", "x", "", "x", "x", "", "", "", "", "x", "x", "x", "", "", "")
Ordinal <- c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "x", "", "", "", "", "", "", "", "")

DataFrame.NombreDeLaVariables <- data.frame(NombreDeLaVariables, Continua,Discreta,Nominal,Ordinal)

print(DataFrame.NombreDeLaVariables)

```

### 3. (6 puntos) Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.
Segun lo que hemos investigado y tambien a los conocimientos previos que se han tenido sobre estadistica, se utiliza la curtoses para verificar cuantos datos se encuentran cerca de la media. se determina que las variables cuantitativas tuvieron un coeficiente mayor a uno, (positivo).
referencia: https://economipedia.com/definiciones/curtosis.html


Libreria para utilizar la curstosis

```{r}
#instalar
#install.packages('e1071')
library(e1071)

```

Curtosis de popularidad
```{r}
popularity = datos$popularity
kurtosis(popularity)
```


Curtosis de budget(presupuesto)
```{r}
budget = datos$budget
kurtosis(budget)

```


Curtosis de revenue
```{r}
revenue = datos$revenue
kurtosis(revenue)
```


Curtosis de runtime
```{r}
runtime = datos$runtime
kurtosis(runtime)
```


Curtosis de VoteCount
```{r}
vote_count = datos$voteCount
kurtosis(vote_count)
```


Curtosis de VoteAvg
```{r}
vote_average = datos$voteAvg
kurtosis(vote_average)
```


Curtosis de GenresAmount
```{r}
GenresA = datos$genresAmount
kurtosis(GenresA)
```


Curtosis de productionCoAmount
```{r}
ProductionCoA = datos$productionCoAmount
kurtosis(ProductionCoA)
```


Curtosis de ProductCountriesAmount
```{r}
ProducCountrieA = datos$productionCountriesAmount
kurtosis(ProducCountrieA)
```


Curtosis de ActorsAmount
```{r}
ActorsA = datos$actorsAmount
kurtosis(ActorsA)
```


Curtosis de CastMenAmount
```{r}
datos$castMenAmount<-as.numeric(datos$castMenAmount)
castMale = datos$castMenAmount
kurtosis(castMale, na.rm = T)
```

Curtosis de CastWomenAmount
```{r}
datos$castWomenAmount<-as.numeric(datos$castWomenAmount)
castWomen = datos$castWomenAmount
kurtosis(castWomen, na.rm = T)
```

##### Variables cualitativas tabla de frecuencias

original_title
```{r}
#table(datos$originalTitle)
```

originalLanguage
```{r}
table(datos$originalLanguage)
```
title
```{r}
#table(datos$title)
```

homePage
```{r}
#table(datos$homePage)
```

video
```{r}
table(datos$video)
```
director
```{r}
#table(datos$director)

```
genres
```{r}
#table(datos$genres)

```
productionCompany
```{r}
#table(datos$productionCompany)

```
productionCompanyCountry
```{r}
#table(datos$productionCompanyCountry)

```
productionCountry
```{r}
#table(datos$productionCountry)
```

releaseDate
```{r}
#table(datos$releaseDate)

```

actors
```{r}
#table(datos$actors)

```

actorsPopularity
```{r}
#table(datos$actorsPopularity)

```

actorsCharacter
```{r}
#table(datos$actorsCharacter)

```

## 4. Responda las siguientes preguntas:

### 4.1. (3 puntos) ¿Cuáles son las 10 películas que contaron con más presupuesto?
```{r}
topbudget <- head(order(datos$budget, decreasing = T),n=10)
datos[topbudget, c("title",("budget"))]
```

### 4.2. (3 puntos) ¿Cuáles son las 10 películas que más ingresos tuvieron?
```{r}
toprevenue <- head(order(datos$revenue, decreasing = T), n=10)
datos[toprevenue,c("title","revenue")]
```

### 4.3. (3 puntos) ¿Cuál es la película que más votos tuvo?
```{r}
topcount <- head(order(datos$voteCount, decreasing = T), n=1)
datos[topcount,c("title","voteCount")]
```

### 4.4. (3 puntos) ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

### 4.5. (8 puntos) ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras
```{r}
#title, titulo
#releaseDAte, fecha de lanzamiento
Dates <- data.frame(datos$title, datos$releaseDate)
PorAnioDesc <- data.frame(Dates[order(Dates$datos.releaseDate),])
year1 <- data.frame(table(substring(PorAnioDesc$datos.releaseDate,1,4)))
finales <- as.numeric(substring(PorAnioDesc$datos.releaseDate,1,4))
hist(finales,breaks = 100)
```


### 4.6. (9 puntos) ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico
```{r}
LicaPopular <- datos[order(datos$popularity,decreasing = TRUE),]
top20 <- LicaPopular[1:20,c("genres")]
genres20 <- unlist(strsplit(as.character(top20), "\\|"))
genres20
```

El genero principal de las peliculas es:
```{r}
getmode <- function(v) {
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

topGenre20 <- getmode(genres20)
topGenre20

```

```{r}
totalGenres <- unlist(strsplit(as.character(datos$genres), "\\|"))
barplot(table(totalGenres))
```

### 4.7. (8 puntos) ¿Las películas de qué genero principal obtuvieron mayores ganancias?

### 4.8. (3 puntos) ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho películas con más actores en los últimos años?

### 4.9. (3 puntos) ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

### 4.10. (8 puntos) ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?

### 4.11. (8 puntos) ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión

### 4.12. (7 puntos) ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?

### 4.13. (8 puntos) ¿En qué meses se han visto los lanzamientos con mejores ingresos?¿cuantas películas, en promedio, se han lanzado por mes?

### 4.14. (7 puntos) ¿Cómo se correlacionan las calificaciones con el éxito comercial?

### 4.15. (5 puntos) ¿A qué género principal pertenecen las películas más largas?

### 5. (¡10 puntos extras!) Genere usted otras seis preguntas que le parezcan interesantes porque le permitan realizar otras exploraciones y respondalas. No puede repetir ninguna de las instrucciones anteriores.
